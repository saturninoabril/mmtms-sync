{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://mattermost.com/schemas/tm-sync/scan-result.json",
  "title": "Scan Result Schema",
  "description": "Schema for scan command output",
  "type": "object",
  "properties": {
    "summary": {
      "type": "object",
      "description": "Summary statistics by sync status",
      "properties": {
        "totalTests": {
          "type": "number",
          "minimum": 0,
          "description": "Total number of tests scanned"
        },
        "synced": {
          "type": "number",
          "minimum": 0,
          "description": "Number of synced tests"
        },
        "unsynced": {
          "type": "number",
          "minimum": 0,
          "description": "Number of unsynced tests"
        },
        "needsUpdate": {
          "type": "number",
          "minimum": 0,
          "description": "Number of tests needing update"
        },
        "conflict": {
          "type": "number",
          "minimum": 0,
          "description": "Number of conflicted tests"
        },
        "orphaned": {
          "type": "number",
          "minimum": 0,
          "description": "Number of orphaned tests"
        },
        "validationError": {
          "type": "number",
          "minimum": 0,
          "description": "Number of tests with validation errors"
        }
      },
      "required": ["totalTests", "synced", "unsynced", "needsUpdate", "conflict", "orphaned", "validationError"]
    },
    "metrics": {
      "type": "object",
      "description": "Calculated metrics",
      "properties": {
        "syncCoverage": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Percentage of synced tests (0-100)"
        },
        "documentationCompliance": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Percentage of tests with valid documentation (0-100)"
        },
        "averageDocumentationScore": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Average documentation quality score (0-100)"
        }
      },
      "required": ["syncCoverage", "documentationCompliance"]
    },
    "fileResults": {
      "type": "array",
      "description": "Per-file scan results",
      "items": {
        "type": "object",
        "properties": {
          "filePath": {
            "type": "string",
            "description": "Test file path"
          },
          "testCount": {
            "type": "number",
            "minimum": 0,
            "description": "Number of tests in file"
          },
          "syncedCount": {
            "type": "number",
            "minimum": 0,
            "description": "Number of synced tests"
          },
          "issues": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "testTitle": {
                  "type": "string"
                },
                "syncStatus": {
                  "type": "string",
                  "enum": ["synced", "unsynced", "needs-update", "conflict", "orphaned", "validation-error"]
                },
                "message": {
                  "type": "string"
                }
              },
              "required": ["testTitle", "syncStatus"]
            }
          }
        },
        "required": ["filePath", "testCount", "syncedCount", "issues"]
      }
    },
    "scannedAt": {
      "type": "string",
      "format": "date-time",
      "description": "Scan timestamp"
    },
    "duration": {
      "type": "number",
      "minimum": 0,
      "description": "Scan duration in milliseconds"
    }
  },
  "required": ["summary", "metrics", "fileResults", "scannedAt", "duration"]
}
